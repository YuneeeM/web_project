<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="css/alarm_dialog.css" />
  <title>노인을 위한 웹 사이트 - 취업게시판 목록</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
  <style>
    body {
      font-size: 20px;
      font-family: 'Jua', sans-serif;
      background-color: #F1F5FF;
    }

    .container {
      margin-left: 100px;
    }

    .location a::before {
      content: '>';
      display: inline-block;
      width: 10px;
      height: 10px;
      margin-right: 5px;
      color: #bbb;
    }


    a:visited {
      color: inherit;
    }

    .location a {
      text-decoration: underline;
    }

    .sub-visual-title {
      margin-bottom: 40px;
    }

    .sub-visual-title .visual {
      display: inline-block;
      vertical-align: middle;
    }


    .sub-visual-title .info {
      display: inline-block;
      vertical-align: middle;
      margin-left: 10px;
      /* 필요한 경우 이미지와 글자 사이의 간격 조정 */
    }

    .sub-visual-title .info .title {
      display: block;
      margin-bottom: 5px;
    }

    .sub-visual-title .info .txt {
      display: block;
    }

    .write-btn {
      margin-top: 10px;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      margin-right: 20px;
      margin-left: auto;
      background-color: #10a1fbbc;
      width: 80px;
      height: 30px;
      text-align: center;
      border-radius: 5px;
      color: #fff;

    }

    .write-btn:hover {
      background-color: #1289d3bc;
    }

    .write-btn a::after {
      color: #fff;
    }

    .write-btn a:visited {
      color: #fff;
    }

    table caption {
      overflow: hidden;
      visibility: hidden;
      ;
    }

    .board-list>thead>tr>th {
      border-bottom: 1px solid #e6e6e6;
      height: 48px;
      padding: 7px 5px;
      background-color: #f7f7f7;
      font-weight: 700;
    }

    table {
      display: table;
      text-indent: initial;
      border-spacing: 2px;
      width: 100%;
      table-layout: fixed;
      border-collapse: collapse;
      empty-cells: show;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    }

    thead {
      display: table-header-group;
      vertical-align: middle;
      border-color: inherit;
    }

    .board-list {
      line-height: 2;
    }

    tbody {
      display: table-row-group;
      vertical-align: middle;
      border-color: inherit;
      background-color: #fff;
    }

    tr {
      display: table-row;
      vertical-align: inherit;
      border-color: inherit;
    }

    table th,
    table td {
      padding: 0;
      word-break: break-all;
    }

    .board-list>tbody>tr>th,
    .board-list>tbody>tr>td {
      height: 48px;
      padding: 16px 5px;
      border: 1px solid #f5f7f9;
      border-width: 0 0 1px 0;
      border-color: #e4ebf1;
      text-align: center;
      word-break: break-all;

    }

    .pagination {
      clear: both;
      position: relative;
      margin: 0 auto;
      padding: 30px 0 0 0;
      text-align: center;
    }

    .pagination .active,
    .pagination a:hover {
      color: #fff;
      line-height: 32px;
      background-color: #10a1fbbc;
      border: 0;
      border-radius: 5px;
    }

    .pagination a,
    .pagination strong,
    .pagination .control {
      display: inline-block;
      position: relative;
      min-width: 30px;
      height: 30px;
      padding: 0 4px;
      text-decoration: none;
      line-height: 30px;
      color: #666;
      font-weight: normal;
      vertical-align: middle;
    }

    #top_bar {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100px;
    }

    #top_bar>a {
      padding-left: 280px;
    }

    #top_bar>div {
      padding: 10px;
    }

    #top_bar>div>img {
      margin-right: 13px;
    }

    #top_bar>div>img:hover {
      cursor: pointer;
      transform: translate(0, -10px);
    }

    #top_bar>a {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 0 auto;
    }

    .img_logo {
      margin-bottom: 10px;
      width: 100px;
      height: 100px;
      text-align: center;
    }

    #menu_bar {
      position: fixed;
      top: 0;
      width: 50px;
      height: 100%;
      background-color: #0099FF;
      z-index: 3;
      overflow: hidden;
      transition: width 0.3s;
    }

    #menu_bar:hover {
      width: 250px;
    }

    #menu_bar ul {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 100px;
    }

    #menu_bar li {
      position: relative;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      width: 100%;
      height: 55px;
      border-bottom: none;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    #menu_bar li:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }

    #menu_bar li .menu_icon {
      width: 30px;
      height: 30px;
      margin-right: 10px;
      background-size: cover;
      opacity: 1;
      transition: opacity 0.3s;
    }

    #menu_bar li:hover .menu_icon {
      opacity: 1;
    }

    #menu_bar li .menu_text {
      position: absolute;
      left: -9999px;
      color: #fff;
    }

    #menu_bar:hover li .menu_text {
      left: 0;
      margin-left: 40px;
      font-size: 25px;
    }

    .icon1 {
      background: url('media/007.png') center center no-repeat;
    }

    .icon2 {
      background: url('media/006.png') center center no-repeat;
    }

    .icon3 {
      background: url('media/004.png') center center no-repeat;
    }

    .icon4 {
      background: url('media/003.png') center center no-repeat;
    }

    .icon5 {
      background: url('media/005.png') center center no-repeat;
    }

    .icon6 {
      background: url('media/002.png') center center no-repeat;
    }

    .icon7 {
      background: url('media/001.png') center center no-repeat;
    }

    .icon8 {
      background: url('media/mildo.png') center center no-repeat;
    }

    .icon10 {
      background: url('media/img_funding.png') center center no-repeat;
    }

    #sample_data {
      margin-left: 100px;
    }

    #pagination {
      display: flex;
      justify-content: center;
      align-items: center;
    }
  </style>
</head>

<body>
  <header id="top_bar">
    <a href="startpage.html"><img src="media/logo-removebg-preview.png" class="img_logo"></a>
    <div>
      <button id="alarmButton" class="alarmButton"><img src="media/free-icon-alarm-bell-1059065.png" width="50px"
          height="50px"></button>
      <img src="media/free-icon-search-2697422.png" width="50px" height="50px" alt="검색" style="margin-right: 5px;">
      <img src="media/free-icon-enter-1828395.png" onclick=" checklogin('loginpage.html')" width="50px" height="50px"
        alt="로그인">
      <img src="media/free-icon-person-5393061.png" onclick="checkAuthTokenAndRedirect_login('mypage.html')"
        width="50px" height="50px" alt="마이페이지">
    </div>
  </header>

  <div class="modal" id="modal">
    <div class="modal-content">
      <h2>최신 일자리</h2>
      <button class="close-button" id="closeButton">닫기</button>
    </div>
  </div>

  <nav id="menu_bar">
    <div id="menu_nav">
      <ul>
        <li onclick="checkAuthTokenAndRedirect('bokjiapi_homeless.html')">
          <span class="menu_icon icon1"></span>
          <span class="menu_text">노숙인 복지시설</span>
        </li>
        <li onclick="checkAuthTokenAndRedirect('bokjiapi_order.html')">
          <span class="menu_icon icon2"></span>
          <span class="menu_text">노인 복지시설</span>
        </li>
        <li onclick="checkAuthTokenAndRedirect('fundingpage.html')">
          <span class="menu_icon icon10"></span>
          <span class="menu_text">지원금 정보</span>
        </li>
        <li onclick="checkAuthTokenAndRedirect('worknet_post.html')">
          <span class="menu_icon icon3"></span>
          <span class="menu_text">구인정보(사기업)</span>
        </li>
        <li onclick="checkAuthTokenAndRedirect('openapi_workpost.html')">
          <span class="menu_icon icon4"></span>
          <span class="menu_text">구인정보(공공)</span>
        </li>
        <li onclick="location.href='bokjimildo.html'">
          <span class="menu_icon icon8"></span>
          <span class="menu_text">복지시설 밀도</span>
        </li>
        <li onclick="location.href='self_check_nutrition.html'">
          <span class="menu_icon icon5"></span>
          <span class="menu_text">건강 및 영양</span>
        </li>
        <li onclick="location.href='main_post.html'">
          <span class="menu_icon icon6"></span>
          <span class="menu_text">자유게시판</span>
        </li>
        <li onclick="checkAuthTokenAndRedirect_login('mypage.html')">
          <span class="menu_icon icon7"></span>
          <span class="menu_text">마이페이지</span>
        </li>
      </ul>
    </div>
  </nav>


  <div class="container" id="container">
    <div class="sub-util">
      <div class="location">
        <i class="iconset ico-home">홈</i>
        <a href="./startpage.html">시작페이지</a>
        <a href="./main_post.html"><strong>자유 게시판</strong></a>
      </div>
    </div>
    <div class="inner-wrap no-lab">
      <div id="contents">
        <section id="contents">
          <div class="title-util">
            <h2 class="title">자유 게시판</h2>
          </div>

        </section>
      </div>
    </div>
    <div class="sub-visual-title">
      <div class="visual"><img src="media/free-icon-family-4547180.png" width="150px" height="150px" alt></div>
      <div class="info">
        <strong class="title">노인 및 노숙인 소식</strong>
        <span class="txt">취업 성공 사례 및 복지 시설 이용 경험을 공유합시다!</span>
      </div>
    </div>
    <div class="board-list-count">
      <p class="count">전체 <strong class="font-lblue">0</strong> 건</p>

    </div>
    <div class="table-wrap">
      <table class="board-list">
        <caption>노인 노숙인 게시판 목록</caption>
        <colgroup>
          <col width="10%">
          <col width="30%">
          <col width="20%">
          <col width="20%">
          <col width="20%">
        </colgroup>
        <thead>
          <tr>
            <th scope="col">번호</th>
            <th scope="col">제목</th>
            <th scope="col">작성자</th>
            <th scope="col">좋아요 수</th>
            <th scope="col">등록일</th>
          </tr>
        </thead>
        <tbody id="post-table-body">
          <!-- 동적으로 생성되는 부분 -->
        </tbody>
      </table>
      <div class="write-btn" id="write-btn"><a href="post_write.html" style="text-decoration: none;">글쓰기</a></div>

    </div>
    <nav class="pagination">
    </nav>
  </div>
  <script>
    // post_list를 localStorage에서 검색합니다.
    const postList = JSON.parse(localStorage.getItem('post_list'));

    // 테이블 본문 요소에 대한 참조를 가져옵니다.
    const tableBody = document.getElementById('post-table-body');

    // 게시물을 한 페이지에 표시할 개수를 정의합니다.
    const itemsPerPage = 5;

    // 현재 페이지 번호를 URL 매개변수에서 가져옵니다.
    const urlParams = new URLSearchParams(window.location.search);
    const currentPage = parseInt(urlParams.get('page')) || 1;

    // 전체 페이지 수를 계산합니다.
    const totalPages = Math.ceil(postList.length / itemsPerPage);

    // 게시물 리스트에서 현재 페이지에 해당하는 게시물들을 추출합니다.
    const startIndex = (currentPage - 1) * itemsPerPage;
    const endIndex = startIndex + itemsPerPage;
    const currentPagePosts = postList.slice(startIndex, endIndex);

    // 게시물 리스트를 기반으로 동적으로 테이블 행과 셀을 생성합니다.
    if (currentPagePosts && currentPagePosts.length > 0) {
      currentPagePosts.forEach((post, index) => {
        // 새로운 테이블 행을 생성합니다.
        const row = document.createElement('tr');

        // 번호 셀을 생성하고 값 설정합니다.
        const numberCell = document.createElement('td');
        numberCell.textContent = index + startIndex + 1;
        row.appendChild(numberCell);

        // 제목 셀을 생성하고 값 설정합니다.
        const titleCell = document.createElement('td');
        titleCell.textContent = post.title;
        row.appendChild(titleCell);

        // 작성자 셀을 생성하고 값 설정합니다.
        const authorCell = document.createElement('td');
        authorCell.textContent = post.writer;
        row.appendChild(authorCell);

        // 좋아요 수 셀을 생성하고 값 설정합니다.
        const likesCell = document.createElement('td');
        likesCell.textContent = post.likes ? post.likes : 0; // 저장된 값이 존재하면 출력하고, 없으면 0을 출력합니다.
        row.appendChild(likesCell);

        // 등록일 셀을 생성하고 값 설정합니다.
        const dateCell = document.createElement('td');
        dateCell.textContent = post.createdDate;
        row.appendChild(dateCell);

        // 생성된 행을 테이블 본문에 추가합니다.
        tableBody.appendChild(row);
      });

      // 전체 게시물 개수를 가져옵니다.
      const totalCount = postList ? postList.length : 0;

      // 전체 게시물 개수를 표시하는 요소에 접근합니다.
      const countElement = document.querySelector('.count strong.font-lblue');

      // 개수를 업데이트합니다.
      countElement.textContent = totalCount;

      // 페이지네이션 생성
      const numPageLinks = 2; // 현재 페이지 주변에 표시할 페이지 수

      // 페이지네이션 컨테이너 요소에 접근합니다.
      const pagination = document.querySelector('.pagination');

      // 이전 페이지 링크 생성 및 추가
      if (currentPage > 1) {
        const prevPageLink = document.createElement('a');
        prevPageLink.textContent = '이전';
        prevPageLink.href = `?page=${currentPage - 1}`;
        pagination.appendChild(prevPageLink);
      }

      // 페이지 번호 링크 생성 및 추가
      for (let i = 1; i <= totalPages; i++) {
        const pageLink = document.createElement('a');
        pageLink.textContent = i;
        pageLink.href = `?page=${i}`;

        if (i === currentPage) {
          pageLink.classList.add('active');
        }

        pagination.appendChild(pageLink);
      }

      // 다음 페이지 링크 생성 및 추가
      if (currentPage < totalPages) {
        const nextPageLink = document.createElement('a');
        nextPageLink.textContent = '다음';
        nextPageLink.href = `?page=${currentPage + 1}`;
        pagination.appendChild(nextPageLink);
      }

      // 동적으로 생성된 행들에 대해 클릭 이벤트를 추가합니다.
      const rows = document.querySelectorAll('#post-table-body tr');
      rows.forEach((row, index) => {
        row.addEventListener('click', () => {
          // 해당 게시물의 상세 페이지 URL을 가져옵니다.
          const postDetailURL = `./post_detail.html?id=${startIndex + index + 1}`;

          // 상세 페이지로 이동합니다.
          window.location.href = postDetailURL;
        });
      });
    }
  </script>


  <script>
    const alarmButton = document.getElementById('alarmButton');
    const modal = document.getElementById('modal');
    const closeButton = document.getElementById('closeButton');

    // localStorage에서 authToken 가져오기
    var token_a = parseInt(localStorage.getItem("authToken"));


    if (token_a == 0) {
      alarmButton.style.display = 'none';
    }


    alarmButton.addEventListener('click', () => {
      modal.style.display = 'block';
    });

    closeButton.addEventListener('click', () => {
      modal.style.display = 'none';
    });

  </script>

  <script>
    function checkAuthTokenAndRedirect(page) {
      // localStorage에서 authToken 가져오기
      var token = parseInt(localStorage.getItem("authToken"));

      if (token === 0) {
        location.href = 'memberinfo_post.html';
      } else {
        location.href = page;
      }
    }

    function checkAuthTokenAndRedirect_login(page) {
      // localStorage에서 authToken 가져오기
      var token = parseInt(localStorage.getItem("authToken"));

      if (token === 0) {

        // 확인 메시지 출력
        var confirmLogin = confirm("로그인을 하셔야 접속할 수 있습니다!");


        if (confirmLogin) {

          window.location.href = 'loginpage.html';
        }
        else {

        }

      } else {
        location.href = page;
      }
    }

    function checklogin(page) {

      // localStorage에서 authToken 가져오기
      var token = parseInt(localStorage.getItem("authToken"));


      if (token === 0) {

        window.location.href = page;


      } else {

        // 확인 메시지 출력
        var confirmLogin = confirm("로그아웃 하시겠습니까?");
        if (confirmLogin) {

          // authToken 값을 null로 변경
          localStorage.setItem("authToken", 0);

          // startpage.html로 이동
          window.location.href = "startpage.html";
        }
        else {
          // startpage.html로 이동
          window.location.href = "startpage.html";
        }
      }

    }

  </script>

</body>

</html>