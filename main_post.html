<!DOCTYPE html>
<html>

<head>
  <title>노인을 위한 웹 사이트 - 취업게시판 목록</title>
  <link rel="stylesheet" type="text/css" href="style.css" />
</head>

<body>
  <div class="container" id="container">
    <div class="sub-util">
      <div class="location">
        <i class="iconset ico-home">홈</i>
        <span>자유게시판</span>
        <span><strong>취업 사례 게시판</strong></span>
      </div>
    </div>
    <div class="inner-wrap no-lab">
      <div id="contents">
        <section id="contents">
          <div class="title-util">
            <h2 class="title">취업 사례 게시판</h2>
          </div>

        </section>
      </div>
    </div>
    <div class="sub-visual-title">
      <div class="visual"><img src="media/board_post_icon.jpg" width="150px" height="150px" alt></div>
      <div class="info">
        <strong class="title">노인 및 노숙인 취업 성공 소식</strong>
        <span class="txt">취업 사례를 공유합시다!</span>
      </div>
    </div>
    <div class="board-list-count">
      <p class="count">전체 <strong class="font-lblue">2</strong> 건</p>

    </div>
    <div class="table-wrap">
      <table class="board-list">
        <caption>노인 노숙인 취업사례 목록</caption>
        <colgroup>
          <col style="width: 100px;">
          <col>
          <col style="width: 160px;">
          <col style="width: 140px;">
          <col style="width: 140px;">
        </colgroup>
        <thead>
          <tr>
            <th scope="col">번호</th>
            <th scope="col">제목</th>
            <th scope="col">작성자</th>
            <th scope="col">좋아요 수</th>
            <th scope="col">등록일</th>
          </tr>
        </thead>
        <tbody id="post-table-body">
          <!-- 동적으로 생성되는 부분 -->
        </tbody>
      </table>
      <div id="write-button" class="right-align">
        <button id="back-write"><a href="post_write.html">글쓰기</a></button>
      </div>
    </div>
    <nav class="pagination">
      <strong class="active">1</strong>
    </nav>
  </div>


  <script>
    const postTableBody = document.getElementById("post-table-body");
    const pagination = document.querySelector(".pagination");
    const postsPerPage = 5;
    let currentPage = 1;


    /*전체 건수 계산*/
    const postCountElement = document.querySelector(".count .font-lblue");
    const posts = JSON.parse(localStorage.getItem("posts")) || [];
    const postCount = posts.length;
    postCountElement.textContent = postCount;

    function renderPostList() {
      const posts = JSON.parse(localStorage.getItem("posts")) || [];
      const startIndex = (currentPage - 1) * postsPerPage;
      const endIndex = startIndex + postsPerPage;
      const currentPosts = posts.slice(startIndex, endIndex);

      postTableBody.innerHTML = "";

      currentPosts.forEach((post, index) => {
        const row = document.createElement("tr");
        const numberCell = document.createElement("td");
        const titleCell = document.createElement("td");
        const authorCell = document.createElement("td");
        const likesCell = document.createElement("td");
        const dateCell = document.createElement("td");

        // 제목을 클릭하면 상세 페이지로 이동
        const link = document.createElement("a");
        link.href = `post_detail.html?id=${startIndex + index}&likes=${post.likes || 0}`;
        link.textContent = post.title;
        titleCell.appendChild(link);

        authorCell.textContent = post.author;

        // 좋아요 수 표시
        const likes = post.likes || 0;
        likesCell.textContent = likes;

        // 현재 시스템 상의 시간을 동적으로 받아 등록일로 표시
        const currentDate = new Date();
        const formattedDate = currentDate.toLocaleDateString("ko-KR");
        dateCell.textContent = formattedDate;

        // 순서를 동적으로 받아 번호로 표시
        const number = startIndex + index + 1;
        numberCell.textContent = number;

        row.appendChild(numberCell);
        row.appendChild(titleCell);
        row.appendChild(authorCell);
        row.appendChild(likesCell);
        row.appendChild(dateCell);

        postTableBody.appendChild(row);
      });
      renderPagination(posts.length);
    }



    function renderPagination(totalPosts) {
      pagination.innerHTML = "";

      const totalPages = Math.ceil(totalPosts / postsPerPage);

      for (let i = 1; i <= totalPages; i++) {
        const pageLink = document.createElement("a");
        pageLink.href = "#";
        pageLink.textContent = i;

        if (i === currentPage) {
          pageLink.classList.add("active");
        }

        pageLink.addEventListener("click", () => {
          currentPage = i;
          renderPostList();
        });

        pagination.appendChild(pageLink);
      }
    }

    renderPostList();
  </script>
</body>

</html>